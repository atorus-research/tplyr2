<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Post-Processing • tplyr2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Post-Processing">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tplyr2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/tplyr2.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Layer Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/desc.html">Descriptive Statistics Layers</a></li>
    <li><a class="dropdown-item" href="../articles/count.html">Count Layers</a></li>
    <li><a class="dropdown-item" href="../articles/shift.html">Shift Layers</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Formatting</h6></li>
    <li><a class="dropdown-item" href="../articles/general_string_formatting.html">General String Formatting</a></li>
    <li><a class="dropdown-item" href="../articles/desc_layer_formatting.html">Advanced Descriptive Statistics Formatting</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Table Customization</h6></li>
    <li><a class="dropdown-item" href="../articles/sort.html">Sorting a tplyr2 Table</a></li>
    <li><a class="dropdown-item" href="../articles/denom.html">Denominators</a></li>
    <li><a class="dropdown-item" href="../articles/options.html">tplyr2 Options</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Metadata</h6></li>
    <li><a class="dropdown-item" href="../articles/metadata.html">Metadata and Traceability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced</h6></li>
    <li><a class="dropdown-item" href="../articles/riskdiff.html">Risk Difference</a></li>
    <li><a class="dropdown-item" href="../articles/analyze.html">Custom Analysis Layers</a></li>
    <li><a class="dropdown-item" href="../articles/serialization.html">Spec Serialization</a></li>
    <li><a class="dropdown-item" href="../articles/ard.html">Analysis Results Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Post-Processing</h6></li>
    <li><a class="dropdown-item" href="../articles/post_processing.html">Post-Processing</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Migration</h6></li>
    <li><a class="dropdown-item" href="../articles/migration.html">Migrating from Tplyr v1</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Post-Processing</h1>
            
      

      <div class="d-none name"><code>post_processing.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code><a href="../reference/tplyr_build.html">tplyr_build()</a></code> produces a data.frame with
<code>rowlabel*</code>, <code>res*</code>, and <code>ord_layer_*</code>
columns. This output is complete and correct, but it is not yet ready
for a polished report. Row labels still repeat across consecutive rows.
Multiple label columns need collapsing into one. And depending on the
output format, leading whitespace may need special handling.</p>
<p>tplyr2 provides a set of post-processing functions that transform
build output into display-ready tables. This vignette walks through each
of them, starting with the most common operations and ending with
utility functions for targeted tasks.</p>
</div>
<div class="section level2">
<h2 id="building-the-example-data">Building the Example Data<a class="anchor" aria-label="anchor" href="#building-the-example-data"></a>
</h2>
<p>We will use a multi-layer table throughout this vignette so that the
effect of each post-processing step is visible. The spec combines a
demographics count layer with a descriptive statistics layer on age.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_spec.html">tplyr_spec</a></span><span class="op">(</span></span>
<span>  cols <span class="op">=</span> <span class="st">"TRT01P"</span>,</span>
<span>  layers <span class="op">=</span> <span class="fu"><a href="../reference/tplyr_layers.html">tplyr_layers</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/group_count.html">group_count</a></span><span class="op">(</span><span class="st">"DCDECOD"</span>,</span>
<span>      by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/label.html">label</a></span><span class="op">(</span><span class="st">"Disposition"</span><span class="op">)</span>, <span class="st">"EOSSTT"</span><span class="op">)</span>,</span>
<span>      settings <span class="op">=</span> <span class="fu"><a href="../reference/layer_settings.html">layer_settings</a></span><span class="op">(</span></span>
<span>        format_strings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          n_counts <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xxx (xx.x%)"</span>, <span class="st">"n"</span>, <span class="st">"pct"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/group_desc.html">group_desc</a></span><span class="op">(</span><span class="st">"AGE"</span>,</span>
<span>      by <span class="op">=</span> <span class="fu"><a href="../reference/label.html">label</a></span><span class="op">(</span><span class="st">"Age (years)"</span><span class="op">)</span>,</span>
<span>      settings <span class="op">=</span> <span class="fu"><a href="../reference/layer_settings.html">layer_settings</a></span><span class="op">(</span></span>
<span>        format_strings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          <span class="st">"Mean (SD)"</span> <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xxx.x (xxx.xx)"</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span><span class="op">)</span>,</span>
<span>          <span class="st">"Median"</span>    <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xxx.x"</span>, <span class="st">"median"</span><span class="op">)</span>,</span>
<span>          <span class="st">"Min, Max"</span>  <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xxx, xxx"</span>, <span class="st">"min"</span>, <span class="st">"max"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_build.html">tplyr_build</a></span><span class="op">(</span><span class="va">spec</span>, <span class="va">tplyr_adsl</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="st">"rowlabel2"</span>, <span class="st">"res1"</span>, <span class="st">"res2"</span>, <span class="st">"res3"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">rowlabel1</th>
<th align="left">rowlabel2</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Disposition</td>
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">Disposition</td>
<td align="left">COMPLETED</td>
<td align="left">58 (67.4%)</td>
<td align="left">27 (32.1%)</td>
<td align="left">25 (29.8%)</td>
</tr>
<tr class="odd">
<td align="left">Disposition</td>
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">Disposition</td>
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">Disposition</td>
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">Disposition</td>
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">Disposition</td>
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">Disposition</td>
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">Disposition</td>
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">Disposition</td>
<td align="left">DISCONTINUED</td>
<td align="left">8 ( 9.3%)</td>
<td align="left">40 (47.6%)</td>
<td align="left">44 (52.4%)</td>
</tr>
<tr class="odd">
<td align="left">Disposition</td>
<td align="left">DISCONTINUED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">Disposition</td>
<td align="left">DISCONTINUED</td>
<td align="left">2 ( 2.3%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 1.2%)</td>
</tr>
</tbody>
</table>
<p>Notice that <code>rowlabel1</code> repeats across rows within each
grouping, and that the two layers are stacked without any visual
separation. The post-processing functions address both of these
issues.</p>
</div>
<div class="section level2">
<h2 id="row-masks">Row Masks<a class="anchor" aria-label="anchor" href="#row-masks"></a>
</h2>
<p><code><a href="../reference/apply_row_masks.html">apply_row_masks()</a></code> walks each <code>rowlabel*</code>
column top-to-bottom and blanks any value that is identical to the row
above it. This deduplication respects layer boundaries, so a label that
appears at the end of one layer and the beginning of another is never
accidentally blanked.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">masked</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_row_masks.html">apply_row_masks</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">masked</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="st">"rowlabel2"</span>, <span class="st">"res1"</span>, <span class="st">"res2"</span>, <span class="st">"res3"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">rowlabel1</th>
<th align="left">rowlabel2</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Disposition</td>
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">58 (67.4%)</td>
<td align="left">27 (32.1%)</td>
<td align="left">25 (29.8%)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">DISCONTINUED</td>
<td align="left">8 ( 9.3%)</td>
<td align="left">40 (47.6%)</td>
<td align="left">44 (52.4%)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">2 ( 2.3%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 1.2%)</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="adding-row-breaks-between-layers">Adding Row Breaks Between Layers<a class="anchor" aria-label="anchor" href="#adding-row-breaks-between-layers"></a>
</h3>
<p>When <code>row_breaks = TRUE</code>, a blank row is inserted at every
layer boundary. Combined with masking, this gives the table a clean,
sectioned appearance.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">masked_breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_row_masks.html">apply_row_masks</a></span><span class="op">(</span><span class="va">result</span>, row_breaks <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">masked_breaks</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="st">"rowlabel2"</span>, <span class="st">"res1"</span>, <span class="st">"res2"</span>, <span class="st">"res3"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">rowlabel1</th>
<th align="left">rowlabel2</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Disposition</td>
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">58 (67.4%)</td>
<td align="left">27 (32.1%)</td>
<td align="left">25 (29.8%)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">DISCONTINUED</td>
<td align="left">8 ( 9.3%)</td>
<td align="left">40 (47.6%)</td>
<td align="left">44 (52.4%)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">2 ( 2.3%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 1.2%)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">3 ( 3.5%)</td>
<td align="left">1 ( 1.2%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">1 ( 1.2%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 1.2%)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="collapsing-row-labels">Collapsing Row Labels<a class="anchor" aria-label="anchor" href="#collapsing-row-labels"></a>
</h2>
<p>Many display formats expect a single row label column rather than
separate <code>rowlabel1</code>, <code>rowlabel2</code>, etc.
<code><a href="../reference/collapse_row_labels.html">collapse_row_labels()</a></code> takes the specified columns and
collapses them into one column. Repeating parent values are split into
their own rows, and each nesting level receives progressively more
indentation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">collapsed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/collapse_row_labels.html">collapse_row_labels</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"rowlabel1"</span>, <span class="st">"rowlabel2"</span>, indent <span class="op">=</span> <span class="st">"   "</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">collapsed</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"row_label"</span>, <span class="st">"res1"</span>, <span class="st">"res2"</span>, <span class="st">"res3"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Disposition</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">COMPLETED</td>
<td align="left">58 (67.4%)</td>
<td align="left">27 (32.1%)</td>
<td align="left">25 (29.8%)</td>
</tr>
<tr class="even">
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">COMPLETED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">DISCONTINUED</td>
<td align="left">8 ( 9.3%)</td>
<td align="left">40 (47.6%)</td>
<td align="left">44 (52.4%)</td>
</tr>
<tr class="even">
<td align="left">DISCONTINUED</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
</tbody>
</table>
<p>The columns to collapse are provided as character strings (at least
two are required). The <code>indent</code> parameter accepts any string
— it is repeated at each nesting level. The output column name defaults
to <code>"row_label"</code> but can be changed via
<code>target_col</code>.</p>
</div>
<div class="section level2">
<h2 id="extracting-numeric-values">Extracting Numeric Values<a class="anchor" aria-label="anchor" href="#extracting-numeric-values"></a>
</h2>
<p>Formatted tplyr2 strings like <code>"  5 ( 6.1%)"</code> are useful
for display, but sometimes you need the underlying numbers for
programmatic comparisons, sorting, or conditional formatting.
<code><a href="../reference/str_extract_num.html">str_extract_num()</a></code> pulls out the Nth numeric value from each
string.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract the count (first number) from the first result column</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/str_extract_num.html">str_extract_num</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">res1</span>, index <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">counts</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  0 58  0  0  0  0  0  0</span></span>
<span></span>
<span><span class="co"># Extract the percentage (second number)</span></span>
<span><span class="va">pcts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/str_extract_num.html">str_extract_num</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">res1</span>, index <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pcts</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  0.0 67.4  0.0  0.0  0.0  0.0  0.0  0.0</span></span></code></pre></div>
<p>This function handles negative numbers, decimals, and missing values
gracefully. It returns <code>NA</code> when the requested index exceeds
the number of numeric values in a cell.</p>
</div>
<div class="section level2">
<h2 id="conditional-formatting">Conditional Formatting<a class="anchor" aria-label="anchor" href="#conditional-formatting"></a>
</h2>
<p><code><a href="../reference/apply_conditional_format.html">apply_conditional_format()</a></code> allows you to conditionally
re-format a string of numbers based on a numeric value within the string
itself. By selecting a “format group” (targeting a specific number
within the string, numbered left to right), you can establish a
condition upon which a replacement string is used. Either the
replacement can replace the entire string, or it can refill just the
format group while preserving the original width and alignment.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">string</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">" 0  (0.0%)"</span>, <span class="st">" 8  (9.3%)"</span>, <span class="st">"78 (90.7%)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Replace the full string when the percentage (2nd format group) is 0</span></span>
<span><span class="fu"><a href="../reference/apply_conditional_format.html">apply_conditional_format</a></span><span class="op">(</span><span class="va">string</span>, <span class="fl">2</span>, <span class="va">x</span> <span class="op">==</span> <span class="fl">0</span>, <span class="st">" 0        "</span>, full_string <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] " 0        " " 8  (9.3%)" "78 (90.7%)"</span></span>
<span></span>
<span><span class="co"># Replace within the format group when the percentage is less than 1</span></span>
<span><span class="fu"><a href="../reference/apply_conditional_format.html">apply_conditional_format</a></span><span class="op">(</span><span class="va">string</span>, <span class="fl">2</span>, <span class="va">x</span> <span class="op">&lt;</span> <span class="fl">1</span>, <span class="st">"(&lt;1%)"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] " 0   (&lt;1%)" " 8  (9.3%)" "78 (90.7%)"</span></span></code></pre></div>
<p>The <code>format_group</code> parameter selects which numeric value
in the string to evaluate (1st number, 2nd number, etc.). The
<code>condition</code> is an expression using the variable name
<code>x</code> that tests the selected number. When
<code>full_string = FALSE</code> (the default), the replacement is
padded to preserve column alignment within the format group’s character
space.</p>
</div>
<div class="section level2">
<h2 id="replacing-leading-whitespace">Replacing Leading Whitespace<a class="anchor" aria-label="anchor" href="#replacing-leading-whitespace"></a>
</h2>
<p>tplyr2 uses leading spaces to align numbers within format fields.
This works in fixed-width contexts (PDFs, monospaced fonts), but HTML
collapses consecutive spaces. <code><a href="../reference/replace_leading_whitespace.html">replace_leading_whitespace()</a></code>
swaps each leading space for a non-breaking space (<code>\u00a0</code>),
preserving alignment in web-based output.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"  5 ( 6.1%)"</span>, <span class="st">" 12 (14.6%)"</span>, <span class="st">"  3 ( 3.7%)"</span><span class="op">)</span></span>
<span><span class="va">replaced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/replace_leading_whitespace.html">replace_leading_whitespace</a></span><span class="op">(</span><span class="va">original</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show the difference (non-breaking spaces are invisible but present)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">original</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 11 11 11</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">replaced</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 11 11 11</span></span></code></pre></div>
<p>The <code>replace_with</code> parameter defaults to
<code>"\u00a0"</code> but can be set to any string. For example, you
might use <code>"&amp;nbsp;"</code> for raw HTML output.</p>
</div>
<div class="section level2">
<h2 id="standalone-format-application">Standalone Format Application<a class="anchor" aria-label="anchor" href="#standalone-format-application"></a>
</h2>
<p>The <code><a href="../reference/apply_formats.html">apply_formats()</a></code> function is the engine behind all of
tplyr2’s string formatting, but it can also be used on its own. Given an
<code>f_str</code> object and matching numeric vectors, it returns
formatted character strings.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fmt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xxx.x (xxx.xx)"</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/apply_formats.html">apply_formats</a></span><span class="op">(</span><span class="va">fmt</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">75.3</span>, <span class="fl">68.1</span>, <span class="fl">80.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8.21</span>, <span class="fl">7.55</span>, <span class="fl">9.03</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] " 75.3 (  8.21)" " 68.1 (  7.55)" " 80.5 (  9.03)"</span></span></code></pre></div>
<p>This is useful when you need to format numbers from external data
sources using the same format strings that drive your tplyr2 tables. The
precision system is also available through the <code>precision</code>
parameter for auto-precision formatting.</p>
</div>
<div class="section level2">
<h2 id="text-wrapping">Text Wrapping<a class="anchor" aria-label="anchor" href="#text-wrapping"></a>
</h2>
<p><code><a href="../reference/str_indent_wrap.html">str_indent_wrap()</a></code> wraps long text strings to a specified
width while automatically preserving any existing indentation and
applying hyphenation to words that exceed the column width.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RENAL AND URINARY DISORDERS"</span>, <span class="st">"   NEPHROLITHIASIS"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="../reference/str_indent_wrap.html">str_indent_wrap</a></span><span class="op">(</span><span class="va">ex_text</span>, width <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"\n\n"</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; RENAL</span></span>
<span><span class="co">#&gt; AND</span></span>
<span><span class="co">#&gt; URINARY</span></span>
<span><span class="co">#&gt; DISORDE-</span></span>
<span><span class="co">#&gt; RS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    NEPHROL-</span></span>
<span><span class="co">#&gt;    ITHIASI-</span></span>
<span><span class="co">#&gt;    S</span></span></code></pre></div>
<p>The function automatically detects leading whitespace in each element
and preserves it on wrapped continuation lines. Long words that exceed
the column width are split with hyphens. Tabs are converted to spaces
using the <code>tab_width</code> parameter (default 5).</p>
</div>
<div class="section level2">
<h2 id="putting-it-all-together">Putting It All Together<a class="anchor" aria-label="anchor" href="#putting-it-all-together"></a>
</h2>
<p>In practice, you will chain several post-processing steps together.
Here is a complete pipeline that takes raw build output and produces a
display-ready table.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_spec.html">tplyr_spec</a></span><span class="op">(</span></span>
<span>  cols <span class="op">=</span> <span class="st">"TRTA"</span>,</span>
<span>  layers <span class="op">=</span> <span class="fu"><a href="../reference/tplyr_layers.html">tplyr_layers</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/group_count.html">group_count</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AEBODSYS"</span>, <span class="st">"AEDECOD"</span><span class="op">)</span>,</span>
<span>      settings <span class="op">=</span> <span class="fu"><a href="../reference/layer_settings.html">layer_settings</a></span><span class="op">(</span></span>
<span>        distinct_by <span class="op">=</span> <span class="st">"USUBJID"</span>,</span>
<span>        format_strings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          n_counts <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xxx (xx.x%)"</span>, <span class="st">"distinct_n"</span>, <span class="st">"distinct_pct"</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        total_row <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        total_row_label <span class="op">=</span> <span class="st">"Any adverse event"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_build.html">tplyr_build</a></span><span class="op">(</span><span class="va">spec</span>, <span class="va">tplyr_adae</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Post-processing pipeline</span></span>
<span><span class="va">display</span> <span class="op">&lt;-</span> <span class="va">output</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/collapse_row_labels.html">collapse_row_labels</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="st">"rowlabel2"</span>, indent <span class="op">=</span> <span class="st">"   "</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">display</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"row_label"</span>, <span class="st">"res1"</span>, <span class="st">"res2"</span>, <span class="st">"res3"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="54%">
<col width="15%">
<col width="15%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="left">row_label</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Any adverse event</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">32 (100.0%)</td>
<td align="left">43 (100.0%)</td>
<td align="left">50 (100.0%)</td>
</tr>
<tr class="odd">
<td align="left">CARDIAC DISORDERS</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">4 (12.5%)</td>
<td align="left">6 (14.0%)</td>
<td align="left">5 (10.0%)</td>
</tr>
<tr class="odd">
<td align="left">ATRIAL FIBRILLATION</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 2.0%)</td>
</tr>
<tr class="even">
<td align="left">ATRIAL FLUTTER</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 2.3%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">ATRIAL HYPERTROPHY</td>
<td align="left">1 ( 3.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">BUNDLE BRANCH BLOCK RIGHT</td>
<td align="left">1 ( 3.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">CARDIAC FAILURE CONGESTIVE</td>
<td align="left">1 ( 3.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">MYOCARDIAL INFARCTION</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 2.3%)</td>
<td align="left">2 ( 4.0%)</td>
</tr>
<tr class="odd">
<td align="left">SINUS BRADYCARDIA</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">3 ( 7.0%)</td>
<td align="left">1 ( 2.0%)</td>
</tr>
<tr class="even">
<td align="left">SUPRAVENTRICULAR EXTRASYSTOLES</td>
<td align="left">1 ( 3.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 2.0%)</td>
</tr>
<tr class="odd">
<td align="left">SUPRAVENTRICULAR TACHYCARDIA</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 2.0%)</td>
</tr>
<tr class="even">
<td align="left">TACHYCARDIA</td>
<td align="left">1 ( 3.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">VENTRICULAR EXTRASYSTOLES</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 2.3%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">CONGENITAL, FAMILIAL AND GENETIC DISORDERS</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 2.3%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">VENTRICULAR SEPTAL DEFECT</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 2.3%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">GASTROINTESTINAL DISORDERS</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">6 (18.8%)</td>
<td align="left">4 ( 9.3%)</td>
<td align="left">3 ( 6.0%)</td>
</tr>
</tbody>
</table>
<p>When combining <code><a href="../reference/apply_row_masks.html">apply_row_masks()</a></code> and
<code><a href="../reference/collapse_row_labels.html">collapse_row_labels()</a></code>, note that
<code><a href="../reference/collapse_row_labels.html">collapse_row_labels()</a></code> inserts its own stub rows and removes
the original label columns, so it typically replaces the need for
<code><a href="../reference/apply_row_masks.html">apply_row_masks()</a></code>. For deeply nested tables (3+ label
columns), applying <code><a href="../reference/apply_row_masks.html">apply_row_masks()</a></code> on the raw output
first can still be useful.</p>
<div class="section level3">
<h3 id="adding-conditional-formatting-to-the-pipeline">Adding Conditional Formatting to the Pipeline<a class="anchor" aria-label="anchor" href="#adding-conditional-formatting-to-the-pipeline"></a>
</h3>
<p>You can apply conditional formatting to the result columns before
collapsing labels. Here we replace the percentage with
<code>(&lt;1%)</code> in the placebo arm when the percentage rounds to 0
but the count is non-zero.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply conditional formatting before collapsing labels</span></span>
<span><span class="va">output</span><span class="op">$</span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_conditional_format.html">apply_conditional_format</a></span><span class="op">(</span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">res1</span>, <span class="fl">2</span>, <span class="va">x</span> <span class="op">==</span> <span class="fl">0</span>, <span class="st">"(&lt;1%)"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">display_formatted</span> <span class="op">&lt;-</span> <span class="va">output</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/collapse_row_labels.html">collapse_row_labels</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="st">"rowlabel2"</span>, indent <span class="op">=</span> <span class="st">"   "</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">display_formatted</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"row_label"</span>, <span class="st">"res1"</span>, <span class="st">"res2"</span>, <span class="st">"res3"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Any adverse event</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">32 (100.0%)</td>
<td align="left">43 (100.0%)</td>
<td align="left">50 (100.0%)</td>
</tr>
<tr class="odd">
<td align="left">CARDIAC DISORDERS</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">4 (12.5%)</td>
<td align="left">6 (14.0%)</td>
<td align="left">5 (10.0%)</td>
</tr>
<tr class="odd">
<td align="left">ATRIAL FIBRILLATION</td>
<td align="left">0 (&lt;1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 2.0%)</td>
</tr>
<tr class="even">
<td align="left">ATRIAL FLUTTER</td>
<td align="left">0 (&lt;1%)</td>
<td align="left">1 ( 2.3%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">ATRIAL HYPERTROPHY</td>
<td align="left">1 ( 3.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">BUNDLE BRANCH BLOCK RIGHT</td>
<td align="left">1 ( 3.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">CARDIAC FAILURE CONGESTIVE</td>
<td align="left">1 ( 3.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">MYOCARDIAL INFARCTION</td>
<td align="left">0 (&lt;1%)</td>
<td align="left">1 ( 2.3%)</td>
<td align="left">2 ( 4.0%)</td>
</tr>
<tr class="odd">
<td align="left">SINUS BRADYCARDIA</td>
<td align="left">0 (&lt;1%)</td>
<td align="left">3 ( 7.0%)</td>
<td align="left">1 ( 2.0%)</td>
</tr>
<tr class="even">
<td align="left">SUPRAVENTRICULAR EXTRASYSTOLES</td>
<td align="left">1 ( 3.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 2.0%)</td>
</tr>
<tr class="odd">
<td align="left">SUPRAVENTRICULAR TACHYCARDIA</td>
<td align="left">0 (&lt;1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 2.0%)</td>
</tr>
<tr class="even">
<td align="left">TACHYCARDIA</td>
<td align="left">1 ( 3.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">VENTRICULAR EXTRASYSTOLES</td>
<td align="left">0 (&lt;1%)</td>
<td align="left">1 ( 2.3%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>The post-processing functions in tplyr2 serve distinct purposes but
are designed to work together:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th align="left">Function</th>
<th align="left">Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code><a href="../reference/apply_row_masks.html">apply_row_masks()</a></code></td>
<td align="left">Blank repeated row labels, optionally insert row
breaks</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/collapse_row_labels.html">collapse_row_labels()</a></code></td>
<td align="left">Merge label columns into one with indentation</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/str_extract_num.html">str_extract_num()</a></code></td>
<td align="left">Pull numeric values from formatted strings</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/apply_conditional_format.html">apply_conditional_format()</a></code></td>
<td align="left">Conditionally reformat strings based on numeric values
within them</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/replace_leading_whitespace.html">replace_leading_whitespace()</a></code></td>
<td align="left">Swap leading spaces for non-breaking spaces</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/apply_formats.html">apply_formats()</a></code></td>
<td align="left">Format numeric vectors using f_str objects</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/str_indent_wrap.html">str_indent_wrap()</a></code></td>
<td align="left">Wrap long text with hyphenation and indentation
preservation</td>
</tr>
</tbody>
</table>
<p>A typical pipeline runs <code><a href="../reference/apply_row_masks.html">apply_row_masks()</a></code> first, then
<code><a href="../reference/collapse_row_labels.html">collapse_row_labels()</a></code>. Conditional formatting and
whitespace replacement can be inserted wherever they make sense for your
output format.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mike Stackhouse.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
