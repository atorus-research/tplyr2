<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Table Properties • tplyr2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Table Properties">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tplyr2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/tplyr2.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Table Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/table.html">Table Properties</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Layer Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/desc.html">Descriptive Statistics Layers</a></li>
    <li><a class="dropdown-item" href="../articles/count.html">Count Layers</a></li>
    <li><a class="dropdown-item" href="../articles/shift.html">Shift Layers</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Formatting</h6></li>
    <li><a class="dropdown-item" href="../articles/general_string_formatting.html">General String Formatting</a></li>
    <li><a class="dropdown-item" href="../articles/desc_layer_formatting.html">Advanced Descriptive Statistics Formatting</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Table Customization</h6></li>
    <li><a class="dropdown-item" href="../articles/sort.html">Sorting a tplyr2 Table</a></li>
    <li><a class="dropdown-item" href="../articles/denom.html">Denominators</a></li>
    <li><a class="dropdown-item" href="../articles/options.html">tplyr2 Options</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Metadata</h6></li>
    <li><a class="dropdown-item" href="../articles/metadata.html">Metadata and Traceability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced</h6></li>
    <li><a class="dropdown-item" href="../articles/riskdiff.html">Risk Difference</a></li>
    <li><a class="dropdown-item" href="../articles/analyze.html">Custom Analysis Layers</a></li>
    <li><a class="dropdown-item" href="../articles/serialization.html">Spec Serialization</a></li>
    <li><a class="dropdown-item" href="../articles/ard.html">Analysis Results Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Post-Processing</h6></li>
    <li><a class="dropdown-item" href="../articles/post_processing.html">Post-Processing</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Migration</h6></li>
    <li><a class="dropdown-item" href="../articles/migration.html">Migrating from Tplyr v1</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Table Properties</h1>
            
      

      <div class="d-none name"><code>table.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tplyr2</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In tplyr2, a table is defined by its <strong>specification</strong>.
The <code><a href="../reference/tplyr_spec.html">tplyr_spec()</a></code> function captures the full configuration –
column variables, filters, treatment groups, population data, and layers
– as a pure description of what you want. No data processing happens
until you call <code><a href="../reference/tplyr_build.html">tplyr_build()</a></code>. This vignette covers the
spec-level parameters that control the overall structure of your
table.</p>
<p>Every tplyr2 workflow follows two steps: <strong>define</strong> a
spec with <code><a href="../reference/tplyr_spec.html">tplyr_spec()</a></code>, then <strong>build</strong> the
table with <code>tplyr_build(spec, data)</code>. Let’s look at an
example using the included <code>tplyr_adsl</code> dataset.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_spec.html">tplyr_spec</a></span><span class="op">(</span></span>
<span>  cols <span class="op">=</span> <span class="st">"TRT01P"</span>,</span>
<span>  layers <span class="op">=</span> <span class="fu"><a href="../reference/tplyr_layers.html">tplyr_layers</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/group_count.html">group_count</a></span><span class="op">(</span>target_var <span class="op">=</span> <span class="st">"SEX"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_build.html">tplyr_build</a></span><span class="op">(</span><span class="va">spec</span>, <span class="va">tplyr_adsl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^res"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">rowlabel1</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">F</td>
<td align="left">53 (61.6%)</td>
<td align="left">40 (47.6%)</td>
<td align="left">50 (59.5%)</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">33 (38.4%)</td>
<td align="left">44 (52.4%)</td>
<td align="left">34 (40.5%)</td>
</tr>
</tbody>
</table>
<p>Note how the <code>cols</code> parameter defines the column structure
of the output. Each unique value of <code>TRT01P</code> becomes a result
column, and the column labels automatically include the group count as
<code>(N=xx)</code>.</p>
</div>
<div class="section level2">
<h2 id="column-variables">Column Variables<a class="anchor" aria-label="anchor" href="#column-variables"></a>
</h2>
<p>The <code>cols</code> parameter accepts a character vector of one or
more variable names that define the columns of your output table. The
most common case is a single treatment variable:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_spec.html">tplyr_spec</a></span><span class="op">(</span></span>
<span>  cols <span class="op">=</span> <span class="st">"TRT01P"</span>,</span>
<span>  layers <span class="op">=</span> <span class="fu"><a href="../reference/tplyr_layers.html">tplyr_layers</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/group_count.html">group_count</a></span><span class="op">(</span>target_var <span class="op">=</span> <span class="st">"AGEGR1"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_build.html">tplyr_build</a></span><span class="op">(</span><span class="va">spec</span>, <span class="va">tplyr_adsl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^res"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">rowlabel1</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">65-80</td>
<td align="left">42 (48.8%)</td>
<td align="left">55 (65.5%)</td>
<td align="left">47 (56.0%)</td>
</tr>
<tr class="even">
<td align="left">&lt;65</td>
<td align="left">14 (16.3%)</td>
<td align="left">11 (13.1%)</td>
<td align="left">8 ( 9.5%)</td>
</tr>
<tr class="odd">
<td align="left">&gt;80</td>
<td align="left">30 (34.9%)</td>
<td align="left">18 (21.4%)</td>
<td align="left">29 (34.5%)</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="multiple-column-variables">Multiple Column Variables<a class="anchor" aria-label="anchor" href="#multiple-column-variables"></a>
</h3>
<p>When you provide multiple variables, tplyr2 creates a cross of all
combinations. This is useful when you need columns split by treatment
and another variable.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_spec.html">tplyr_spec</a></span><span class="op">(</span></span>
<span>  cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRT01P"</span>, <span class="st">"SEX"</span><span class="op">)</span>,</span>
<span>  layers <span class="op">=</span> <span class="fu"><a href="../reference/tplyr_layers.html">tplyr_layers</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/group_count.html">group_count</a></span><span class="op">(</span>target_var <span class="op">=</span> <span class="st">"AGEGR1"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_build.html">tplyr_build</a></span><span class="op">(</span><span class="va">spec</span>, <span class="va">tplyr_adsl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^res"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="13%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left">rowlabel1</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
<th align="left">res4</th>
<th align="left">res5</th>
<th align="left">res6</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">65-80</td>
<td align="left">22 (41.5%)</td>
<td align="left">20 (60.6%)</td>
<td align="left">28 (70.0%)</td>
<td align="left">27 (61.4%)</td>
<td align="left">28 (56.0%)</td>
<td align="left">19 (55.9%)</td>
</tr>
<tr class="even">
<td align="left">&lt;65</td>
<td align="left">9 (17.0%)</td>
<td align="left">5 (15.2%)</td>
<td align="left">5 (12.5%)</td>
<td align="left">6 (13.6%)</td>
<td align="left">5 (10.0%)</td>
<td align="left">3 ( 8.8%)</td>
</tr>
<tr class="odd">
<td align="left">&gt;80</td>
<td align="left">22 (41.5%)</td>
<td align="left">8 (24.2%)</td>
<td align="left">7 (17.5%)</td>
<td align="left">11 (25.0%)</td>
<td align="left">17 (34.0%)</td>
<td align="left">12 (35.3%)</td>
</tr>
</tbody>
</table>
<p>Notice that the column labels use a <code>" | "</code> separator to
show the cross of treatment and sex, and each combination gets its own
N.</p>
</div>
</div>
<div class="section level2">
<h2 id="table-level-filtering-with-where">Table-Level Filtering with <code>where</code><a class="anchor" aria-label="anchor" href="#table-level-filtering-with-where"></a>
</h2>
<p>The <code>where</code> parameter applies a filter to all data before
any layer processing begins. This is useful when records should be
excluded from the entire table.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_spec.html">tplyr_spec</a></span><span class="op">(</span></span>
<span>  cols <span class="op">=</span> <span class="st">"TRT01P"</span>,</span>
<span>  where <span class="op">=</span> <span class="va">SAFFL</span> <span class="op">==</span> <span class="st">"Y"</span>,</span>
<span>  layers <span class="op">=</span> <span class="fu"><a href="../reference/tplyr_layers.html">tplyr_layers</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/group_count.html">group_count</a></span><span class="op">(</span>target_var <span class="op">=</span> <span class="st">"AGEGR1"</span>, by <span class="op">=</span> <span class="st">"Age Group"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/group_desc.html">group_desc</a></span><span class="op">(</span></span>
<span>      target_var <span class="op">=</span> <span class="st">"AGE"</span>,</span>
<span>      by <span class="op">=</span> <span class="st">"Age (Years)"</span>,</span>
<span>      settings <span class="op">=</span> <span class="fu"><a href="../reference/layer_settings.html">layer_settings</a></span><span class="op">(</span></span>
<span>        format_strings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          <span class="st">"n"</span>         <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xxx"</span>, <span class="st">"n"</span><span class="op">)</span>,</span>
<span>          <span class="st">"Mean (SD)"</span> <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xx.x (xx.xx)"</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span><span class="op">)</span>,</span>
<span>          <span class="st">"Median"</span>    <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xx.x"</span>, <span class="st">"median"</span><span class="op">)</span>,</span>
<span>          <span class="st">"Min, Max"</span>  <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xx, xx"</span>, <span class="st">"min"</span>, <span class="st">"max"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_build.html">tplyr_build</a></span><span class="op">(</span><span class="va">spec</span>, <span class="va">tplyr_adsl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="st">"rowlabel2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^res"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">rowlabel1</th>
<th align="left">rowlabel2</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Age Group</td>
<td align="left">65-80</td>
<td align="left">42 (48.8%)</td>
<td align="left">55 (65.5%)</td>
<td align="left">47 (56.0%)</td>
</tr>
<tr class="even">
<td align="left">Age Group</td>
<td align="left">&lt;65</td>
<td align="left">14 (16.3%)</td>
<td align="left">11 (13.1%)</td>
<td align="left">8 ( 9.5%)</td>
</tr>
<tr class="odd">
<td align="left">Age Group</td>
<td align="left">&gt;80</td>
<td align="left">30 (34.9%)</td>
<td align="left">18 (21.4%)</td>
<td align="left">29 (34.5%)</td>
</tr>
<tr class="even">
<td align="left">Age (Years)</td>
<td align="left">n</td>
<td align="left">86</td>
<td align="left">84</td>
<td align="left">84</td>
</tr>
<tr class="odd">
<td align="left">Age (Years)</td>
<td align="left">Mean (SD)</td>
<td align="left">75.2 ( 8.59)</td>
<td align="left">74.4 ( 7.89)</td>
<td align="left">75.7 ( 8.29)</td>
</tr>
<tr class="even">
<td align="left">Age (Years)</td>
<td align="left">Median</td>
<td align="left">76.0</td>
<td align="left">76.0</td>
<td align="left">77.5</td>
</tr>
<tr class="odd">
<td align="left">Age (Years)</td>
<td align="left">Min, Max</td>
<td align="left">52, 89</td>
<td align="left">56, 88</td>
<td align="left">51, 88</td>
</tr>
</tbody>
</table>
<p>Both the count and descriptive statistics layers are computed on the
safety population. Individual layers can also have their own
<code>where</code> filters, which are applied in addition to the
table-level filter.</p>
</div>
<div class="section level2">
<h2 id="treatment-groups">Treatment Groups<a class="anchor" aria-label="anchor" href="#treatment-groups"></a>
</h2>
<p>Clinical tables often need columns beyond the individual treatment
arms. tplyr2 provides <strong>total groups</strong> and <strong>custom
groups</strong> for this purpose.</p>
<div class="section level3">
<h3 id="total-groups">Total Groups<a class="anchor" aria-label="anchor" href="#total-groups"></a>
</h3>
<p>A total group creates a synthetic column that includes all subjects
by duplicating every row with the column variable set to the total group
label.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_spec.html">tplyr_spec</a></span><span class="op">(</span></span>
<span>  cols <span class="op">=</span> <span class="st">"TRT01P"</span>,</span>
<span>  total_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/total_group.html">total_group</a></span><span class="op">(</span><span class="st">"TRT01P"</span>, label <span class="op">=</span> <span class="st">"Total"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  layers <span class="op">=</span> <span class="fu"><a href="../reference/tplyr_layers.html">tplyr_layers</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/group_count.html">group_count</a></span><span class="op">(</span>target_var <span class="op">=</span> <span class="st">"SEX"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_build.html">tplyr_build</a></span><span class="op">(</span><span class="va">spec</span>, <span class="va">tplyr_adsl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^res"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">rowlabel1</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
<th align="left">res4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">F</td>
<td align="left">53 (61.6%)</td>
<td align="left">143 (56.3%)</td>
<td align="left">40 (47.6%)</td>
<td align="left">50 (59.5%)</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">33 (38.4%)</td>
<td align="left">111 (43.7%)</td>
<td align="left">44 (52.4%)</td>
<td align="left">34 (40.5%)</td>
</tr>
</tbody>
</table>
<p>The “Total” column now appears alongside the individual treatment
arms, with its N reflecting the sum of all subjects.</p>
</div>
<div class="section level3">
<h3 id="custom-groups">Custom Groups<a class="anchor" aria-label="anchor" href="#custom-groups"></a>
</h3>
<p>Custom groups combine specific treatment levels into a new group. For
example, you might pool the two active dose groups together.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_spec.html">tplyr_spec</a></span><span class="op">(</span></span>
<span>  cols <span class="op">=</span> <span class="st">"TRT01P"</span>,</span>
<span>  custom_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/custom_group.html">custom_group</a></span><span class="op">(</span></span>
<span>      <span class="st">"TRT01P"</span>,</span>
<span>      <span class="st">"Xanomeline"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Xanomeline High Dose"</span>, <span class="st">"Xanomeline Low Dose"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  layers <span class="op">=</span> <span class="fu"><a href="../reference/tplyr_layers.html">tplyr_layers</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/group_count.html">group_count</a></span><span class="op">(</span>target_var <span class="op">=</span> <span class="st">"SEX"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_build.html">tplyr_build</a></span><span class="op">(</span><span class="va">spec</span>, <span class="va">tplyr_adsl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^res"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">rowlabel1</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
<th align="left">res4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">F</td>
<td align="left">53 (61.6%)</td>
<td align="left">90 (53.6%)</td>
<td align="left">40 (47.6%)</td>
<td align="left">50 (59.5%)</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">33 (38.4%)</td>
<td align="left">78 (46.4%)</td>
<td align="left">44 (52.4%)</td>
<td align="left">34 (40.5%)</td>
</tr>
</tbody>
</table>
<p>The “Xanomeline” column includes all subjects from both dose groups,
while the original dose-level columns are preserved.</p>
</div>
<div class="section level3">
<h3 id="combining-total-and-custom-groups">Combining Total and Custom Groups<a class="anchor" aria-label="anchor" href="#combining-total-and-custom-groups"></a>
</h3>
<p>You can use both together. Custom groups are applied first, and then
total groups duplicate all rows (including the custom group rows). This
means the “Total” column will include subjects from the custom group as
well.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_spec.html">tplyr_spec</a></span><span class="op">(</span></span>
<span>  cols <span class="op">=</span> <span class="st">"TRT01P"</span>,</span>
<span>  custom_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/custom_group.html">custom_group</a></span><span class="op">(</span></span>
<span>      <span class="st">"TRT01P"</span>,</span>
<span>      <span class="st">"Xanomeline"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Xanomeline High Dose"</span>, <span class="st">"Xanomeline Low Dose"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  total_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/total_group.html">total_group</a></span><span class="op">(</span><span class="st">"TRT01P"</span>, label <span class="op">=</span> <span class="st">"Total"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  layers <span class="op">=</span> <span class="fu"><a href="../reference/tplyr_layers.html">tplyr_layers</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/group_count.html">group_count</a></span><span class="op">(</span>target_var <span class="op">=</span> <span class="st">"SEX"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_build.html">tplyr_build</a></span><span class="op">(</span><span class="va">spec</span>, <span class="va">tplyr_adsl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^res"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="15%">
<col width="16%">
<col width="18%">
<col width="16%">
<col width="16%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="left">rowlabel1</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
<th align="left">res4</th>
<th align="left">res5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">F</td>
<td align="left">53 (61.6%)</td>
<td align="left">233 (55.2%)</td>
<td align="left">90 (53.6%)</td>
<td align="left">40 (47.6%)</td>
<td align="left">50 (59.5%)</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">33 (38.4%)</td>
<td align="left">189 (44.8%)</td>
<td align="left">78 (46.4%)</td>
<td align="left">44 (52.4%)</td>
<td align="left">34 (40.5%)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="population-data">Population Data<a class="anchor" aria-label="anchor" href="#population-data"></a>
</h2>
<p>In many clinical analyses, denominators and header Ns should come
from a different dataset than the analysis data. The classic example is
an adverse event table: <code>ADAE</code> only contains subjects who
experienced events, but percentages should reflect the full safety
population from <code>ADSL</code>.</p>
<p>The <code><a href="../reference/pop_data.html">pop_data()</a></code> configuration specifies how the
population dataset maps to the spec. The actual data is provided at
build time.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_spec.html">tplyr_spec</a></span><span class="op">(</span></span>
<span>  cols <span class="op">=</span> <span class="st">"TRTA"</span>,</span>
<span>  pop_data <span class="op">=</span> <span class="fu"><a href="../reference/pop_data.html">pop_data</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRTA"</span> <span class="op">=</span> <span class="st">"TRT01A"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  layers <span class="op">=</span> <span class="fu"><a href="../reference/tplyr_layers.html">tplyr_layers</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/group_count.html">group_count</a></span><span class="op">(</span></span>
<span>      target_var <span class="op">=</span> <span class="st">"AEBODSYS"</span>,</span>
<span>      settings <span class="op">=</span> <span class="fu"><a href="../reference/layer_settings.html">layer_settings</a></span><span class="op">(</span></span>
<span>        distinct_by <span class="op">=</span> <span class="st">"USUBJID"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_build.html">tplyr_build</a></span><span class="op">(</span><span class="va">spec</span>, <span class="va">tplyr_adae</span>, pop_data <span class="op">=</span> <span class="va">tplyr_adsl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^res"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="61%">
<col width="12%">
<col width="12%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">rowlabel1</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CARDIAC DISORDERS</td>
<td align="left">5 ( 5.8%)</td>
<td align="left">6 ( 7.1%)</td>
<td align="left">6 ( 7.1%)</td>
</tr>
<tr class="even">
<td align="left">CONGENITAL, FAMILIAL AND GENETIC DISORDERS</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 1.2%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">GASTROINTESTINAL DISORDERS</td>
<td align="left">6 ( 7.0%)</td>
<td align="left">6 ( 7.1%)</td>
<td align="left">3 ( 3.6%)</td>
</tr>
<tr class="even">
<td align="left">GENERAL DISORDERS AND ADMINISTRATION SITE
CONDITIONS</td>
<td align="left">11 (12.8%)</td>
<td align="left">21 (25.0%)</td>
<td align="left">21 (25.0%)</td>
</tr>
<tr class="odd">
<td align="left">IMMUNE SYSTEM DISORDERS</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 1.2%)</td>
</tr>
<tr class="even">
<td align="left">INFECTIONS AND INFESTATIONS</td>
<td align="left">5 ( 5.8%)</td>
<td align="left">4 ( 4.8%)</td>
<td align="left">3 ( 3.6%)</td>
</tr>
<tr class="odd">
<td align="left">INJURY, POISONING AND PROCEDURAL COMPLICATIONS</td>
<td align="left">2 ( 2.3%)</td>
<td align="left">2 ( 2.4%)</td>
<td align="left">2 ( 2.4%)</td>
</tr>
<tr class="even">
<td align="left">INVESTIGATIONS</td>
<td align="left">3 ( 3.5%)</td>
<td align="left">1 ( 1.2%)</td>
<td align="left">1 ( 1.2%)</td>
</tr>
</tbody>
</table>
<p>A few things to note:</p>
<ul>
<li>
<code>cols = "TRTA"</code> matches the treatment variable in
<code>ADAE</code>.</li>
<li>
<code>pop_data(cols = c("TRTA" = "TRT01A"))</code> maps
<code>TRT01A</code> in the population data to <code>TRTA</code> in the
analysis data (format:
<code>c("analysis_name" = "pop_name")</code>).</li>
<li>
<code>distinct_by = "USUBJID"</code> counts each subject once per
body system.</li>
<li>Denominators and column Ns come from the full
<code>tplyr_adsl</code> population.</li>
</ul>
<div class="section level3">
<h3 id="extracting-header-n">Extracting Header N<a class="anchor" aria-label="anchor" href="#extracting-header-n"></a>
</h3>
<p>After building a table with population data, you can extract the
header N values using <code><a href="../reference/tplyr_header_n.html">tplyr_header_n()</a></code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">header_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_header_n.html">tplyr_header_n</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">header_n</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">TRTA</th>
<th align="right">.n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Placebo</td>
<td align="right">86</td>
</tr>
<tr class="even">
<td align="left">Xanomeline High Dose</td>
<td align="right">84</td>
</tr>
<tr class="odd">
<td align="left">Xanomeline Low Dose</td>
<td align="right">84</td>
</tr>
</tbody>
</table>
<p>This is useful when you need to programmatically construct column
headers or integrate with other reporting tools.</p>
</div>
<div class="section level3">
<h3 id="population-data-with-filters">Population Data with Filters<a class="anchor" aria-label="anchor" href="#population-data-with-filters"></a>
</h3>
<p>The population data is <strong>not</strong> subject to the spec-level
<code>where</code> filter. It uses its own <code>where</code> clause,
specified in the <code><a href="../reference/pop_data.html">pop_data()</a></code> call:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_spec.html">tplyr_spec</a></span><span class="op">(</span></span>
<span>  cols <span class="op">=</span> <span class="st">"TRTA"</span>,</span>
<span>  pop_data <span class="op">=</span> <span class="fu"><a href="../reference/pop_data.html">pop_data</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRTA"</span> <span class="op">=</span> <span class="st">"TRT01A"</span><span class="op">)</span>,</span>
<span>    where <span class="op">=</span> <span class="va">SAFFL</span> <span class="op">==</span> <span class="st">"Y"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  layers <span class="op">=</span> <span class="fu"><a href="../reference/tplyr_layers.html">tplyr_layers</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/group_count.html">group_count</a></span><span class="op">(</span></span>
<span>      target_var <span class="op">=</span> <span class="st">"AEBODSYS"</span>,</span>
<span>      settings <span class="op">=</span> <span class="fu"><a href="../reference/layer_settings.html">layer_settings</a></span><span class="op">(</span></span>
<span>        distinct_by <span class="op">=</span> <span class="st">"USUBJID"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_build.html">tplyr_build</a></span><span class="op">(</span><span class="va">spec</span>, <span class="va">tplyr_adae</span>, pop_data <span class="op">=</span> <span class="va">tplyr_adsl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../reference/tplyr_header_n.html">tplyr_header_n</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">TRTA</th>
<th align="right">.n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Placebo</td>
<td align="right">86</td>
</tr>
<tr class="even">
<td align="left">Xanomeline High Dose</td>
<td align="right">84</td>
</tr>
<tr class="odd">
<td align="left">Xanomeline Low Dose</td>
<td align="right">84</td>
</tr>
</tbody>
</table>
<p>This separation is intentional. The table-level <code>where</code>
controls which records are summarized, while <code>pop_data</code>
<code>where</code> controls which subjects contribute to denominators.
In practice these often differ – you might filter AE records to
treatment-emergent events while basing denominators on the full safety
population.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-completion">Data Completion<a class="anchor" aria-label="anchor" href="#data-completion"></a>
</h2>
<p>When building count layers, tplyr2 automatically completes all
combinations of factor levels and cross-variables. If a treatment group
has zero subjects with a given characteristic, a <code>0 (0.0%)</code>
row still appears rather than being dropped.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_spec.html">tplyr_spec</a></span><span class="op">(</span></span>
<span>  cols <span class="op">=</span> <span class="st">"TRT01P"</span>,</span>
<span>  layers <span class="op">=</span> <span class="fu"><a href="../reference/tplyr_layers.html">tplyr_layers</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/group_count.html">group_count</a></span><span class="op">(</span>target_var <span class="op">=</span> <span class="st">"RACE"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_build.html">tplyr_build</a></span><span class="op">(</span><span class="va">spec</span>, <span class="va">tplyr_adsl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^res"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">rowlabel1</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">AMERICAN INDIAN OR ALASKA NATIVE</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 1.2%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">BLACK OR AFRICAN AMERICAN</td>
<td align="left">8 ( 9.3%)</td>
<td align="left">9 (10.7%)</td>
<td align="left">6 ( 7.1%)</td>
</tr>
<tr class="odd">
<td align="left">WHITE</td>
<td align="left">78 (90.7%)</td>
<td align="left">74 (88.1%)</td>
<td align="left">78 (92.9%)</td>
</tr>
</tbody>
</table>
<p>Every race category appears for every treatment group, even when the
count is zero.</p>
<div class="section level3">
<h3 id="limiting-completion-with-limit_data_by">Limiting Completion with <code>limit_data_by</code><a class="anchor" aria-label="anchor" href="#limiting-completion-with-limit_data_by"></a>
</h3>
<p>Sometimes completing all combinations is too aggressive. The
<code>limit_data_by</code> parameter in <code><a href="../reference/layer_settings.html">layer_settings()</a></code>
restricts the completion grid to combinations that actually exist in the
data. This is essential for AE tables where preferred terms should only
appear under their actual body system:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_spec.html">tplyr_spec</a></span><span class="op">(</span></span>
<span>  cols <span class="op">=</span> <span class="st">"TRTA"</span>,</span>
<span>  pop_data <span class="op">=</span> <span class="fu"><a href="../reference/pop_data.html">pop_data</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRTA"</span> <span class="op">=</span> <span class="st">"TRT01A"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  layers <span class="op">=</span> <span class="fu"><a href="../reference/tplyr_layers.html">tplyr_layers</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/group_count.html">group_count</a></span><span class="op">(</span></span>
<span>      target_var <span class="op">=</span> <span class="st">"AEDECOD"</span>,</span>
<span>      by <span class="op">=</span> <span class="st">"AEBODSYS"</span>,</span>
<span>      settings <span class="op">=</span> <span class="fu"><a href="../reference/layer_settings.html">layer_settings</a></span><span class="op">(</span></span>
<span>        distinct_by <span class="op">=</span> <span class="st">"USUBJID"</span>,</span>
<span>        limit_data_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AEBODSYS"</span>, <span class="st">"AEDECOD"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_build.html">tplyr_build</a></span><span class="op">(</span><span class="va">spec</span>, <span class="va">tplyr_adae</span>, pop_data <span class="op">=</span> <span class="va">tplyr_adsl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rowlabel1"</span>, <span class="st">"rowlabel2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^res"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="22%">
<col width="39%">
<col width="12%">
<col width="12%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">rowlabel1</th>
<th align="left">rowlabel2</th>
<th align="left">res1</th>
<th align="left">res2</th>
<th align="left">res3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CARDIAC DISORDERS</td>
<td align="left">ATRIAL FIBRILLATION</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 1.2%)</td>
</tr>
<tr class="even">
<td align="left">CARDIAC DISORDERS</td>
<td align="left">ATRIAL FLUTTER</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 1.2%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">CARDIAC DISORDERS</td>
<td align="left">ATRIAL HYPERTROPHY</td>
<td align="left">1 ( 1.2%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">CARDIAC DISORDERS</td>
<td align="left">BUNDLE BRANCH BLOCK RIGHT</td>
<td align="left">1 ( 1.2%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="odd">
<td align="left">CARDIAC DISORDERS</td>
<td align="left">CARDIAC FAILURE CONGESTIVE</td>
<td align="left">1 ( 1.2%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
<tr class="even">
<td align="left">CARDIAC DISORDERS</td>
<td align="left">MYOCARDIAL INFARCTION</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 1.2%)</td>
<td align="left">2 ( 2.4%)</td>
</tr>
<tr class="odd">
<td align="left">CARDIAC DISORDERS</td>
<td align="left">SINUS BRADYCARDIA</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">3 ( 3.6%)</td>
<td align="left">1 ( 1.2%)</td>
</tr>
<tr class="even">
<td align="left">CARDIAC DISORDERS</td>
<td align="left">SUPRAVENTRICULAR EXTRASYSTOLES</td>
<td align="left">1 ( 1.2%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 1.2%)</td>
</tr>
<tr class="odd">
<td align="left">CARDIAC DISORDERS</td>
<td align="left">SUPRAVENTRICULAR TACHYCARDIA</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 1.2%)</td>
</tr>
<tr class="even">
<td align="left">CARDIAC DISORDERS</td>
<td align="left">TACHYCARDIA</td>
<td align="left">1 ( 1.2%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
</tr>
</tbody>
</table>
<p>With <code>limit_data_by = c("AEBODSYS", "AEDECOD")</code>, tplyr2
only creates rows for body system/preferred term combinations that exist
in the data, while still filling in zeros for treatment groups with no
events for a given combination.</p>
</div>
</div>
<div class="section level2">
<h2 id="where-to-go-from-here">Where to Go From Here<a class="anchor" aria-label="anchor" href="#where-to-go-from-here"></a>
</h2>
<p>This vignette covered the table-level properties that control the
overall structure of your tplyr2 output. For details on specific layer
types and additional features, see:</p>
<ul>
<li>
<strong>Count layers</strong>: <code><a href="../reference/group_count.html">group_count()</a></code> for
frequency tables, including nested counts, distinct subject counts, and
missing value handling</li>
<li>
<strong>Descriptive statistics layers</strong>:
<code><a href="../reference/group_desc.html">group_desc()</a></code> for summary statistics with format strings,
auto-precision, and custom summary functions</li>
<li>
<strong>Shift layers</strong>: <code><a href="../reference/group_shift.html">group_shift()</a></code> for
baseline-by-post-baseline cross-tabulations</li>
<li>
<strong>Ordering</strong>: How tplyr2 sorts rows and controls output
order</li>
<li>
<strong>Options</strong>: Package-level options via
<code><a href="../reference/tplyr2_options.html">tplyr2_options()</a></code>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mike Stackhouse.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
